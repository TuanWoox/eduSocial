<% layout('layouts/indexboilerplate') -%>

<div class="container m-4">
    <h1 class="text-center my-4">Khóa học đã tham gia</h1>

    <% if (user && user.coursesProgress.length > 0) { %>
      <div class="row">
        <% user.coursesProgress.forEach(progress => { %>
            <div class="card mx-2 m-2 course" style="width: 270px; height: 500px;">
                <!-- Thumbnail Image -->
                <img src="<%= progress.courseId.coursethumbnail.url %>" class="card-img-top img-fluid mt-2" alt="..." style="object-fit: cover; height: 40%;">
        
        
                <!-- Card Body with Flexbox for alignment -->
                <div class="card-body d-flex flex-column ">
                    <h5 class="card-title"><%= progress.courseId.title %></h5>
                    
                    <!-- Make sure the description does not overflow and truncate after 50 characters -->
                    <p class="card-text" style="flex-grow: 1; overflow: hidden; text-overflow: ellipsis;">
                        <%= progress.courseId.description.length > 50 ? progress.courseId.description.slice(0, 50) + '...' : progress.courseId.description %>
                    </p>
                    <p class="mb-1"><strong>Chủ đề:</strong> <%= progress.courseId.topic %></p>
                    <p><strong>Truy cập cuối vào:</strong> <%= new Date(progress.lastAccessed).toLocaleString() %></p>
                    <!-- Button aligned at the bottom -->
                    <a href="/courses/<%= progress.courseId._id %>" class="btn btn-primary mt-auto">Tiếp tục học</a>
                </div>
            </div>
            
        <% }); %>
      </div>
    <% } else { %>
      <p class="text-center">You haven't participated in any courses yet.</p>
    <% } %>
</div>
